!function(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory():"function"==typeof define&&define.amd?define([],factory):"object"==typeof exports?exports.xvdom=factory():root.xvdom=factory()}(this,function(){return function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var EMPTY_STRING="",EMPTY_OBJECT={},preInstance={$p:null},MARKER_NODE=document.createComment(EMPTY_STRING),getMarkerNode=function(){return MARKER_NODE.cloneNode(!1)},replaceNode=function(oldNode,newNode){var parentNode=oldNode.parentNode;parentNode&&parentNode.replaceChild(newNode,oldNode)},recycle=function(instance){var pool=instance.$s.recycled;pool&&(pool[instance.key]=instance)},insertBefore=function(parentNode,node,beforeNode){return beforeNode?parentNode.insertBefore(node,beforeNode):parentNode.appendChild(node)},renderArray=function(array,parentNode){for(var length=array.length,i=0,item=void 0;length>i;)item=array[i++],recycle(item),parentNode.removeChild(item.$n)},removeArrayNodesOnlyChild=function(array,parentNode){for(var length=array.length,i=0;length>i;)recycle(array[i++]);parentNode.textContent=""},internalRerenderInstance=function(inst,prevInst){return prevInst.$s===inst.$s&&(inst.$s.u(inst,prevInst),!0)},internalRerenderStatefulComponent=function(stateActions,inst,prevInst,parentInst,componentInstanceProp){if(!internalRerenderInstance(inst,prevInst)){var newNode=render(inst),node=parentInst.$n;inst.$c=prevInst.$c,inst.$t=prevInst.$t,inst.$p=prevInst.$p,inst.$a=stateActions,parentInst.$n=newNode,parentInst[componentInstanceProp]=inst,stateActions.$$instance=inst,newNode.xvdom=parentInst,replaceNode(node,newNode),recycle(inst)}},callAction=function(stateActions,action,parentInst,componentInstanceProp,args){var inst=stateActions.$$instance,props=inst.$p,state=inst.$t,shouldRerender=stateActions.$$doRerender;stateActions.$$doRerender=!1;var newState=action.apply(void 0,[props,state,stateActions].concat(args));return stateActions.$$doRerender=shouldRerender,inst.$t=newState,state!==newState&&shouldRerender&&internalRerenderStatefulComponent(stateActions,inst.$c(props,newState,stateActions),inst,parentInst,componentInstanceProp),newState},createAction=function(stateActions,action,parentInst,componentInstanceProp){return function(){for(var _len=arguments.length,args=Array(_len),_key=0;_len>_key;_key++)args[_key]=arguments[_key];return callAction(stateActions,action,parentInst,componentInstanceProp,args)}},createStateActions=function(rawActions,parentInst,componentInstanceProp,$$instance){var stateActions={$$doRerender:!1,$$instance:$$instance};for(var sa in rawActions)stateActions[sa]=createAction(stateActions,rawActions[sa],parentInst,componentInstanceProp);return stateActions},renderArrayToParentBefore=function(parentNode,array,length,markerNode){for(var i=0;length>i;)insertBefore(parentNode,(array[i]=internalRender(array[i])).$n,markerNode),++i},renderArrayToParent=function(parentNode,array,length){for(var i=0;length>i;)parentNode.appendChild((array[i]=internalRender(array[i])).$n),++i},rerenderArray_reconcileWithMap=function(parentNode,array,oldArray,startIndex,endIndex,oldStartItem,oldStartIndex,oldEndItem,oldEndIndex){for(var oldListNodeKeyMap={},insertBeforeNode=oldEndItem.$n,item=void 0,key=void 0,node=void 0,startItem=void 0;oldEndIndex>=oldStartIndex;)item=oldArray[oldStartIndex++],oldListNodeKeyMap[item.key]=item;for(;endIndex>=startIndex;)startItem=array[startIndex],key=startItem.key,item=oldListNodeKeyMap[key],item?(item===oldEndItem&&(insertBeforeNode=insertBeforeNode.nextSibling),oldListNodeKeyMap[key]=null,node=(array[startIndex]=internalRerender(item,startItem)).$n):node=render(startItem),insertBefore(parentNode,node,insertBeforeNode),++startIndex;for(key in oldListNodeKeyMap)item=oldListNodeKeyMap[key],item&&(recycle(item),parentNode.removeChild(item.$n))},rerenderArray_afterReconcile=function(parentNode,array,oldArray,startIndex,startItem,endIndex,endItem,oldStartIndex,oldStartItem,oldEndIndex,oldEndItem,insertBeforeNode){if(oldStartIndex>oldEndIndex)for(;endIndex>=startIndex;)startItem=array[startIndex],insertBefore(parentNode,(array[startIndex]=internalRender(startItem)).$n,insertBeforeNode),++startIndex;else if(startIndex>endIndex)for(;oldEndIndex>=oldStartIndex;)oldStartItem=oldArray[oldStartIndex++],recycle(oldStartItem),parentNode.removeChild(oldStartItem.$n);else rerenderArray_reconcileWithMap(parentNode,array,oldArray,startIndex,endIndex,oldStartItem,oldStartIndex,oldEndItem,oldEndIndex)},rerenderArray_reconcile=function(parentNode,array,length,oldArray,oldLength,markerNode){var oldStartIndex=0,startIndex=0,successful=!0,endIndex=length-1,oldEndIndex=oldLength-1,startItem=0!==length&&array[0],oldStartItem=0!==oldLength&&oldArray[0],insertBeforeNode=markerNode,oldEndItem=void 0,endItem=void 0,node=void 0;outer:for(;successful&&oldEndIndex>=oldStartIndex&&endIndex>=startIndex;){for(successful=!1;oldStartItem.key===startItem.key;){if(array[startIndex]=internalRerender(oldStartItem,startItem),oldStartIndex++,startIndex++,oldStartIndex>oldEndIndex||startIndex>endIndex)break outer;oldStartItem=oldArray[oldStartIndex],startItem=array[startIndex],successful=!0}for(oldEndItem=oldArray[oldEndIndex],endItem=array[endIndex];oldEndItem.key===endItem.key;){if(insertBeforeNode=(array[endIndex]=internalRerender(oldEndItem,endItem)).$n,oldEndIndex--,endIndex--,oldStartIndex>oldEndIndex||startIndex>endIndex)break outer;oldEndItem=oldArray[oldEndIndex],endItem=array[endIndex],successful=!0}for(;oldStartItem.key===endItem.key;){if(node=(array[endIndex]=internalRerender(oldStartItem,endItem)).$n,oldEndItem.key!==endItem.key&&(insertBeforeNode=insertBefore(parentNode,node,insertBeforeNode)),oldStartIndex++,endIndex--,oldStartIndex>oldEndIndex||startIndex>endIndex)break outer;oldStartItem=oldArray[oldStartIndex],endItem=array[endIndex],successful=!0}for(;oldEndItem.key===startItem.key;){if(insertBefore(parentNode,(array[startIndex]=internalRerender(oldEndItem,startItem)).$n,oldStartItem.$n),oldEndIndex--,startIndex++,oldStartIndex>oldEndIndex||startIndex>endIndex)break outer;oldEndItem=oldArray[oldEndIndex],startItem=array[startIndex],successful=!0}}(endIndex>=startIndex||oldEndIndex>=oldStartIndex)&&rerenderArray_afterReconcile(parentNode,array,oldArray,startIndex,startItem,endIndex,endItem,oldStartIndex,oldStartItem,oldEndIndex,oldEndItem,insertBeforeNode)},rerenderArray=function(parentNode,array,oldArray,markerNode,valuesAndContext,rerenderFuncProp,rerenderContextNode){var length=array.length,oldLength=oldArray.length;length?oldLength?rerenderArray_reconcile(parentNode,array,length,oldArray,oldLength,markerNode):renderArrayToParentBefore(parentNode,array,length,markerNode):renderArray(oldArray,parentNode)},rerenderArrayOnlyChild=function(parentNode,array,oldArray,valuesAndContext,rerenderFuncProp,rerenderContextNode){var length=array.length,oldLength=oldArray.length;length?oldLength?rerenderArray_reconcile(parentNode,array,length,oldArray,oldLength,null):renderArrayToParent(parentNode,array,length):removeArrayNodesOnlyChild(oldArray,parentNode)},rerenderText=function(value,oldValue,contextNode,instance,rerenderFuncProp,rerenderContextNode){return null==value?contextNode.nodeValue=EMPTY_STRING:value.constructor===String||value.constructor===Number?contextNode.nodeValue=value:rerenderDynamic(value,null,contextNode,instance,rerenderFuncProp,rerenderContextNode),value},rerenderTextOnlyChild=function(value,oldValue,contextNode,instance,rerenderFuncProp,rerenderContextNode){return null==value?contextNode.nodeValue=EMPTY_STRING:value.constructor===String||value.constructor===Number?contextNode.nodeValue=value:rerenderDynamicOnlyChild(value,null,contextNode,instance,rerenderFuncProp,rerenderContextNode),value},rerenderDynamic=function(value,oldValue,contextNode,instance,rerenderFuncProp,rerenderContextNode){return replaceNode(contextNode,createDynamic(value,instance,rerenderFuncProp,rerenderContextNode)),value},rerenderDynamicOnlyChild=function(value,oldValue,contextNode,instance,rerenderFuncProp,rerenderContextNode){return replaceNode(contextNode,createDynamicOnlyChild(contextNode.parentNode,value,instance,rerenderFuncProp,rerenderContextNode)),value},rerenderInstance=function(value,prevValue,node,instance,rerenderFuncProp,rerenderContextNode){return value&&internalRerenderInstance(value,prevValue)?prevValue:rerenderDynamic(value,null,node,instance,rerenderFuncProp,rerenderContextNode)},rerenderInstanceOnlyChild=function(value,prevValue,node,instance,rerenderFuncProp,rerenderContextNode){return value&&internalRerenderInstance(value,prevValue)?prevValue:rerenderDynamicOnlyChild(value,null,node,instance,rerenderFuncProp,rerenderContextNode)},rerenderStatefulComponent=function(component,props,prevProps,componentInstance,node,instance,rerenderContextNode,componentInstanceProp){var onProps=componentInstance.$a.onProps;componentInstance.$p=props,onProps?onProps():internalRerenderStatefulComponent(componentInstance.$a,componentInstance.$c(props,componentInstance,componentInstance.$a),componentInstance,instance,componentInstanceProp)},rerenderComponent=function(component,props,prevProps,componentInstance,node,instance,rerenderContextNode,componentInstanceProp){var newCompInstance=component(props||EMPTY_OBJECT);if(!internalRerenderInstance(newCompInstance,componentInstance)){var newNode=render(newCompInstance);instance[componentInstanceProp]=newCompInstance,instance[rerenderContextNode]=newNode,newNode.xvdom=instance,replaceNode(node,newNode)}},rerenderArrayMaybe=function(array,oldArray,markerNode,valuesAndContext,rerenderFuncProp,rerenderContextNode){var parentNode=markerNode.parentNode;return array instanceof Array?rerenderArray(parentNode,array,oldArray,markerNode):(renderArray(oldArray,parentNode),rerenderDynamic(array,null,markerNode,valuesAndContext,rerenderFuncProp,rerenderContextNode)),array},rerenderArrayMaybeOnlyChild=function(array,oldArray,parentNode,valuesAndContext,rerenderFuncProp,rerenderContextNode){return array instanceof Array?rerenderArrayOnlyChild(parentNode,array,oldArray,parentNode):(removeArrayNodesOnlyChild(oldArray,parentNode),parentNode.appendChild(createDynamicOnlyChild(parentNode,array,valuesAndContext,rerenderFuncProp,rerenderContextNode))),array},createStatefulComponent=function(component,props,instance,rerenderFuncProp,rerenderContextNode,componentInstanceProp){preInstance.$p=props;var rawActions=component.state,actions=createStateActions(rawActions,instance,componentInstanceProp,preInstance),state=rawActions.onInit(props||EMPTY_OBJECT,void 0,actions);actions.$$doRerender=!0;var inst=component(props,state,actions),node=render(inst);return actions.$$instance=inst,inst.$c=component,inst.$t=state,inst.$a=actions,inst.$p=props,instance[rerenderFuncProp]=rerenderStatefulComponent,instance[componentInstanceProp]=inst,instance[rerenderContextNode]=node,node},createDynamic=exports.createDynamic=function(value,instance,rerenderFuncProp,rerenderContextNode){var node=void 0,context=void 0,rerenderFunc=void 0,valueConstructor=void 0;return null==value||(valueConstructor=value.constructor)===Boolean?(rerenderFunc=rerenderDynamic,context=node=getMarkerNode()):valueConstructor===Object?(rerenderFunc=rerenderInstance,context=node=render(value)):valueConstructor===String||valueConstructor===Number?(rerenderFunc=rerenderText,context=node=document.createTextNode(value)):valueConstructor===Array&&(node=document.createDocumentFragment(),renderArrayToParent(node,value,value.length),rerenderFunc=rerenderArrayMaybe,context=node.appendChild(getMarkerNode())),instance[rerenderFuncProp]=rerenderFunc,instance[rerenderContextNode]=context,node},createDynamicOnlyChild=exports.createDynamicOnlyChild=function(onlyChildParentNode,value,instance,rerenderFuncProp,rerenderContextNode){var node=void 0,context=void 0,rerenderFunc=void 0,valueConstructor=void 0;return null==value||(valueConstructor=value.constructor)===Boolean?(rerenderFunc=rerenderDynamicOnlyChild,context=node=getMarkerNode()):valueConstructor===Object?(rerenderFunc=rerenderInstanceOnlyChild,context=node=render(value)):valueConstructor===String||valueConstructor===Number?(rerenderFunc=rerenderTextOnlyChild,context=node=document.createTextNode(value)):valueConstructor===Array&&(node=document.createDocumentFragment(),renderArrayToParent(node,value,value.length),rerenderFunc=rerenderArrayMaybeOnlyChild,context=onlyChildParentNode),instance[rerenderFuncProp]=rerenderFunc,instance[rerenderContextNode]=context,node},createComponent=exports.createComponent=function(component,props,instance,rerenderFuncProp,rerenderContextNode,componentInstanceProp){if(component.state)return createStatefulComponent(component,props,instance,rerenderFuncProp,rerenderContextNode,componentInstanceProp);var inst=component(props||EMPTY_OBJECT),node=render(inst);return instance[rerenderFuncProp]=rerenderComponent,instance[componentInstanceProp]=inst,instance[rerenderContextNode]=node,node},internalRender=function(instance){var spec=instance.$s,recycled=spec.recycled,recycledInstance=recycled&&recycled[instance.key];return recycledInstance?(recycled[instance.key]=null,spec.u(instance,recycledInstance),recycledInstance):((instance.$n=spec.c(instance)).xvdom=instance,instance)},render=exports.render=function(instance){return internalRender(instance).$n},internalRerender=function(prevInstance,instance){return internalRerenderInstance(instance,prevInstance)?prevInstance:(instance=internalRender(instance),replaceNode(prevInstance.$n,instance.$n),recycle(prevInstance),instance)},rerender=exports.rerender=function(node,instance){return internalRerender(node.xvdom,instance).$n},unmount=exports.unmount=function(node){node.xvdom&&recycle(node.xvdom),node.parentNode&&node.parentNode.removeChild(node)};exports["default"]={createDynamic:createDynamic,createDynamicOnlyChild:createDynamicOnlyChild,createComponent:createComponent,render:render,rerender:rerender,unmount:unmount};exports._={rerenderText:rerenderText,rerenderInstance:rerenderInstance,rerenderDynamic:rerenderDynamic,rerenderArray:rerenderArrayMaybe,rerenderArrayOnlyChild:rerenderArrayMaybeOnlyChild}}])});
